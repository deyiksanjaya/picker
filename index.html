<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monumen Bersejarah Dunia</title>
    <!-- Memuat Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Memuat Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827;
        }
        .monument-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .monument-card:hover {
            transform: scale(1.03);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2), 0 10px 10px -5px rgba(0, 0, 0, 0.1);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        #touch-blocker {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 9999;
    display: none;

    /* ini yang penting */
    background-color: rgba(0,0,0,0); 
    pointer-events: all;
}
        #permission-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(17, 24, 39, 0.95);
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            cursor: pointer;
            transition: opacity 0.5s ease;
        }
    </style>
</head>
<body class="antialiased text-white">

    <!-- Overlay untuk meminta izin, ini sangat penting untuk Safari -->
    <div id="permission-overlay">
        <div class="px-4">
            <h2 class="text-3xl font-bold">Selamat Datang</h2>
            <p class="mt-2 text-lg text-gray-300">Ketuk untuk memulai dan mengizinkan akses sensor gerak.</p>
        </div>
    </div>
    
    <div id="touch-blocker"></div>

    <header class="relative h-96 flex items-center justify-center text-center overflow-hidden">
        <div class="absolute inset-0 z-0">
            <img src="https://images.unsplash.com/photo-1528181304800-259b08848526?q=80&w=2070&auto=format&fit=crop" alt="Latar Belakang Monumen" class="w-full h-full object-cover opacity-30">
        </div>
        <div class="absolute inset-0 bg-black/50 z-10"></div>
        <div class="relative z-20 px-4">
            <h1 class="text-5xl md:text-7xl font-extrabold tracking-tight">Keajaiban Dunia</h1>
            <p class="mt-4 text-lg md:text-xl text-gray-300 max-w-2xl mx-auto">Sebuah perjalanan visual melintasi waktu, menjelajahi mahakarya arsitektur yang mendefinisikan peradaban manusia.</p>
        </div>
    </header>

    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-12 md:py-16">
        <div id="loading" class="text-center py-16">
            <div class="inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-400"></div>
            <p class="mt-4 text-gray-400">Sedang menyusun perjalanan Anda...</p>
        </div>
        <main id="monuments-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 auto-rows-[25rem] gap-6"></main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const monumentsContainer = document.getElementById('monuments-container');
            const loadingIndicator = document.getElementById('loading');
            const permissionOverlay = document.getElementById('permission-overlay');
            const touchBlocker = document.getElementById('touch-blocker');

            // --- Logika Giroskop & Sensor Gerak (Disempurnakan) ---
            let gyroTriggered = false;
            let isFaceDown = false;

            // Fungsi ini menangani logika orientasi setelah izin diberikan
            const handleOrientation = (event) => {
                if (gyroTriggered || event.beta === null) return;
                
                const beta = event.beta; // Tilt depan-belakang (-180 hingga 180)
                
                // Kondisi 1: Perangkat BELUM dalam kondisi face-down, DAN sekarang TILT-nya menunjukkan face-down.
                if (!isFaceDown && (beta > 165 || beta < -165)) {
                    isFaceDown = true;
                    const statueOfLibertyCard = document.getElementById('monument-card-Statue-of-Liberty');
                    if (statueOfLibertyCard) {
                        statueOfLibertyCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                    touchBlocker.style.display = 'block';
                } 
                // Kondisi 2: Perangkat SUDAH dalam kondisi face-down, DAN sekarang TILT-nya KEMBALI normal.
                else if (isFaceDown && (beta < 150 && beta > -150)) {
                    isFaceDown = false;
                    gyroTriggered = true; // Kunci fitur agar tidak berjalan lagi
                    touchBlocker.style.display = 'none';
                    // Hapus event listener untuk menghemat baterai
                    window.removeEventListener('deviceorientation', handleOrientation, true);
                }
            };
            
            // Fungsi untuk meminta izin akses sensor
            const requestMotionPermission = async () => {
                // Pengecekan ini spesifik untuk Safari di iOS 13+
                if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === 'function') {
                    try {
                        const permissionState = await DeviceOrientationEvent.requestPermission();
                        if (permissionState === 'granted') {
                            window.addEventListener('deviceorientation', handleOrientation, true);
                        }
                    } catch (error) {
                        console.error('Gagal saat meminta izin sensor:', error);
                    }
                } else if (typeof DeviceOrientationEvent !== 'undefined') {
                    // Untuk Android atau browser lain yang tidak memerlukan izin eksplisit
                    window.addEventListener('deviceorientation', handleOrientation, true);
                }
            };
            
            // Event listener untuk overlay. Ini adalah "interaksi pengguna" yang dibutuhkan Safari.
            permissionOverlay.addEventListener('click', () => {
                permissionOverlay.style.opacity = '0';
                setTimeout(() => {
                    permissionOverlay.style.display = 'none';
                }, 500);
                requestMotionPermission();
            }, { once: true });


            // --- Logika Pemuatan Monumen ---
            const monumentList = [ "Colosseum", "Great Wall of China", "Taj Mahal", "Machu Picchu", "Petra", "Eiffel Tower", "Statue of Liberty", "Angkor Wat", "Borobudur", "Acropolis of Athens", "Chichen Itza", "Christ the Redeemer (statue)", "Neuschwanstein Castle", "Sydney Opera House", "Forbidden City", "Hagia Sophia", "Prambanan", "Leaning Tower of Pisa", "Brandenburg Gate", "Himeji Castle", "Sagrada FamÃ­lia" ];

            const fetchMonumentData = async (monumentName) => {
                const apiUrl = `https://en.wikipedia.org/w/api.php?action=query&format=json&prop=pageimages&piprop=thumbnail&pithumbsize=800&titles=${encodeURIComponent(monumentName)}&origin=*`;
                try {
                    const response = await fetch(apiUrl);
                    if (!response.ok) throw new Error('Network response was not ok');
                    const data = await response.json();
                    const pages = data.query.pages;
                    const pageId = Object.keys(pages)[0];
                    if (pageId === "-1") return null;
                    const pageData = pages[pageId];
                    return {
                        title: pageData.title,
                        imageUrl: pageData.thumbnail ? pageData.thumbnail.source : `https://placehold.co/800x600/111827/4b5563?text=${encodeURIComponent(pageData.title)}`
                    };
                } catch (error) {
                    return { title: monumentName, imageUrl: 'https://placehold.co/800x600/111827/4b5563?text=Gagal+Muat' };
                }
            };

            const createMonumentCard = (monument, index) => {
                const uniqueId = `monument-card-${monument.title.replace(/[^a-zA-Z0-9]/g, '-')}`;
                const wikipediaUrl = `https://en.wikipedia.org/wiki/${encodeURIComponent(monument.title)}`;
                const isFeatured = index === 0;
                const gridClasses = isFeatured ? 'lg:col-span-2 lg:row-span-2' : 'lg:col-span-1 lg:row-span-1';
                const titleFontSize = isFeatured ? 'text-4xl' : 'text-2xl';

                return `
                    <div id="${uniqueId}" class="monument-card fade-in group relative rounded-2xl overflow-hidden cursor-pointer ${gridClasses}" style="animation-delay: ${index * 100}ms;" onclick="window.open('${wikipediaUrl}', '_blank')">
                        <img src="${monument.imageUrl}" alt="Gambar ${monument.title}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" onerror="this.onerror=null;this.src='https://placehold.co/800x600/111827/4b5563?text=Gagal+Muat';">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"></div>
                        <div class="absolute bottom-0 left-0 p-6 w-full">
                            <h2 class="${titleFontSize} font-bold tracking-tight">${monument.title}</h2>
                            <button class="mt-2 text-left opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-white/20 backdrop-blur-sm text-white font-semibold py-2 px-4 rounded-lg hover:bg-white/30">
                                Jelajahi &rarr;
                            </button>
                        </div>
                    </div>
                `;
            };

            const loadMonuments = async () => {
                loadingIndicator.style.display = 'block';
                monumentsContainer.innerHTML = '';
                const monumentDataPromises = monumentList.map(fetchMonumentData);
                const monumentsData = await Promise.all(monumentDataPromises);
                loadingIndicator.style.display = 'none';
                monumentsData.forEach((monument, index) => {
                    if (monument) {
                        monumentsContainer.innerHTML += createMonumentCard(monument, index);
                    }
                });
            };

            loadMonuments();
        });
    </script>

</body>
</html>